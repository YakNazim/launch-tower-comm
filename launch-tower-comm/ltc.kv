#:kivy 1.0
#:import kivy kivy
#:import ut kivy.utils

## Set <key> <expr>
#:set conn_green (0, 1, .5, .8)
#:set conn_yellow (1, 1, 0, .8)
#:set conn_red (1, 0, 0, .8)

# Root widget description:
# Derived from the Kivy Showcase example
<LTC>:
    box_layout: box_layout
    settings_button: settings_button

    FloatLayout:
        size: root.size

        # Application name and Kivy Logo are on the top-left:
        BoxLayout:
            padding: 10
            spacing: 10
            size_hint: 1, None
            pos_hint: {'top':1.,}
            height: 24
            Image:
                size_hint: None, None
                size: 24, 24
                source: 'data/logo/kivy-icon-32.png'
            Label:
                height: 24
                text_size: self.size
                color: (1, 1, 1, .8)
                text: 'Launch Tower Comm v%s- Kivy %s' % (root.version, kivy.__version__)

        # Copyright and author name are on the bottom-left:
        Label:
            height: 24
            pos: 10, 10
            text_size: self.size
            color: (1, 1, 1, .8)
            text: 'Â© 2013 by John Boyle'

        # The two big buttons in the middle of the bottom:
        BoxLayout:
            height: 24
            spacing: 30
            padding: 10
            size_hint_y: 0.18
            size_hint_x: None
            #width: 2*(self.height - 2*self.padding) + self.spacing + 2*self.padding
            pos_hint: {'center_x':0.5}
            ToggleButton:
                id: pitch_lock_button
            ToggleButton:
                id: y_axis_volume_button

        # The two little buttons on the bottom-right:
        BoxLayout:
            height: 24
            spacing: 15
            padding: 10
            size_hint_y: 0.15
            size_hint_x: None
            #width: 2*(self.height - 2*self.padding) + self.spacing + 2*self.padding
            pos_hint: {'right':1}
            Button:
                id: look_button

            Button:
                id: settings_button


        # Maybe we could also add an "Exit" button on the top-right?
        Button:
        	size_hint: None, None
        	width: root.width / 30
        	height: self.width
        	pos_hint: {'right':0.98, 'top': 0.95}
        	text: "X"
        	on_press: root.app.stop()

        # Parent widget of the indicators
        BoxLayout
            id: box_layout
            orientation: 'horizontal'
            size_hint_x: 1
            size_hint_y: 0.7
            pos_hint: {'x': 0, 'center_y': 0.5}

# The custom settingspanel for the appearance settings:
<MySettingsPanel>:
    # This declaration will make "content" available externally
    content: content
    canvas:
        Color:
            rgb: 1, 1, 1
        Rectangle:
            source: 'data/images/background.jpg'
            size: self.size

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            padding: '10dp'
            spacing: '10dp'
            size_hint: 1, None
            pos_hint: {'top': 1}
            height: '44dp'
            Image:
                size_hint: None, None
                size: '24dp', '24dp'
                source: 'data/logo/kivy-icon-64.png'
                mipmap: True
            Label:
                height: '24dp'
                text_size: self.width, None
                color: (1, 1, 1, .8)
                text: 'Launch Tower Comm - Kivy %s' % kivy.__version__

        BoxLayout:
            id: content
            orientation: 'horizontal'

<InterfaceKitPanel>:
    labels: labels
    orientation: 'vertical'
    pos_hint: {'x': 0, 'y': 0}
    padding: 10

    # COLUMN LABELS
    BoxLayout:
        id: labels
        orientation: 'horizontal'
        padding: 10
        spacing: 10

        MyLabel:
            text: 'DEVICE'
            font_size: 20

        VSeparator

        MyLabel:
            text: 'Status'
            font_size: 20


<IOIndicator>:
    label_slot: label_slot
    device_label: device_label
    status_ind: status_ind

    BoxLayout:
        id: label_slot

        orientation: 'horizontal'
        padding: 10
        spacing: 10

        MyLabel:
            id: device_label
            text: 'device'

        Label:
            id: status_ind
            text: ' '
            font_size: 30
            canvas:
                Color:
                    rgba: conn_green #if self.text == 'Connected' else conn_red
                Rectangle:
                    size: self.size
                    pos: self.pos


# From the Kivy Showcase example
[VSeparator@Widget]:
    size_hint_x: None
    width: 10
    canvas:
        Color:
            rgba: .8, .8, .8, .3
        Rectangle:
            size: 1, self.height
            pos: self.center_x, self.y

# From the Kivy Showcase example
[HSeparator@Widget]:
    size_hint_y: None
    width: 1
    canvas:
        Color:
            rgba: .8, .8, .8, .3
        Rectangle:
            size: self.width, 10
            pos: self.x, self.center_y

# Derived from the Kivy Showcase example
[MyLabel@Label]:
    size_hint_y: 1
    height: max(dp(45), self.texture_size[1] + dp(10))
    text: ctx.text if 'text' in ctx else ''
    text_size: self.width, self.height
    font_size: ctx.font_size if 'font_size' in ctx else 30
    valign: 'middle'
    halign: 'center'
    canvas.before:
        Color:
            rgba: .2, .2, .2, .8
        Rectangle:
            size: self.size
            pos: self.pos
